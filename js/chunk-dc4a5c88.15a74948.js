(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dc4a5c88"],{"2fe3":function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var i=e("e760"),s=e("4c8d");function r(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(i["a"])(s["q"],n,t)}},"33e7":function(t,n,e){},"4eed":function(t,n,e){"use strict";e.r(n);var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"song"},[e("div",{staticClass:"bgmask"}),e("div",{staticClass:"bg",style:{"background-image":"url("+t.cover+")","background-color":"rgb(255,255,255)"}}),e("div",{staticClass:"music-container"},[e("div",{staticClass:"content"},[e("div",{staticClass:"song-list"},[e("div",{staticClass:"song-container"},[t._m(0),t._l(t.songs,(function(n,i){return e("div",{key:i,staticClass:"item"},[e("span",{class:["song-name",t.item_index==i?"song-active":""]},[t._v(" "+t._s(n.name)+" "),e("img",{directives:[{name:"show",rawName:"v-show",value:i==t.item_index&&t.play,expression:"index==item_index && play"}],attrs:{src:"/img/loading-svg/loading-bars.svg"}})]),e("span",{staticClass:"singer-name",on:{click:function(e){return t.goSingerDetail(n.ar[0].id,n.ar[0].name)}}},[t._v(t._s(n.ar[0].name))]),e("span",{staticClass:"time"},[t._v(t._s(n.format_dt))])])}))],2)]),e("div",{staticClass:"prograss"},[e("div",{staticClass:"left"},[e("div",{staticClass:"iconfont item icon-shangyishouge",on:{click:function(n){t.item_index--}}}),e("div",{class:["item","iconfont",t.play?"icon-zanting":"icon-bofang"],on:{click:t.isplay}}),e("div",{staticClass:"iconfont item icon-kuaijin",on:{click:function(n){t.item_index++}}})]),e("div",{staticClass:"prograss-container"},[e("div",{staticClass:"current-time"}),e("div",{staticClass:"bar",on:{mousedown:t.barDown}})]),e("audio",{attrs:{src:t.url}})])]),e("div",{staticClass:"aside"},[e("div",{staticClass:"current-song"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.songUrl,expression:"songUrl"}],class:[t.play?"animation-rotate":""]})]),e("div",{staticClass:"lyric"},[e("div",{staticClass:"lrc-container"},t._l(t.parseLyric,(function(n,i){return e("span",{key:i,class:["lrc",i==t.active?"active":""]},[t._v(t._s(n.lrc))])})),0)])])])])},s=[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"item"},[e("span",{staticClass:"song-name"},[t._v("歌名")]),e("span",{staticClass:"singer-name"},[t._v("歌手")]),e("span",{staticClass:"time"},[t._v("时长")])])}],r=(e("aa0c"),e("d30f"),e("bbb8"),e("4789"),e("d835"),e("4b0c"),e("ca85")),o=e("2fe3"),a=e("7a1c"),c={name:"song",components:{},data:function(){return{item_index:0,id:0,url:"",songUrl:"",songname:"",cover:"",parseLyric:[],active:0,trackIds:[],songs:[],songNum:20,song_page:0,currentShowNum:0,play:!1,down:!1,prograssDistance:0,currentDistance:0,timeStamp:0,x:0}},watch:{trackIds:function(){var t=this.disposeId();this.getsongdetail(t)},songs:function(){this.songs.forEach((function(t,n,e){var i=a["a"]._msTos(t.dt);e[n].format_dt=i}))},play:function(){var t=document.querySelector("audio");this.play?this.url?t.play():this.$message({showClose:!0,message:"亲爱的,暂无版权",type:"error"}):t.pause()},timeStamp:function(){var t=this.timeStamp*(this.prograssDistance/this.songTime);console.log("x：",t),document.querySelector(".bar").style.left=t+"px",document.querySelector(".current-time").style.width=t+"px",this.x=t},item_index:function(){var t=this.item_index;t<0&&(this.item_index=0),t>=this.currentShowNum&&(this.item_index=this.currentShowNum-1),this.songname=this.songs[this.item_index].name,this.id=this.songs[this.item_index].id,this.dt=this.songs[this.item_index].dt,this.reset(),this.getsongUrl(),this.getlyric(),this.getSongImg()}},created:function(){this.getTrackIds(),this.getsongUrl(),this.getlyric()},mounted:function(){this.prograssInit()},methods:{disposeId:function(){var t=this.song_page*this.songNum,n=t+this.songNum;n=n>=this.trackCount?this.trackCount:n;var e=this.trackIds.slice(t,n),i=a["a"]._arrToString(e);return i},getTrackIds:function(){this.trackIds=JSON.parse(window.localStorage.getItem("playList")),this.id=this.trackIds[0].id,this.cover=window.localStorage.getItem("playListCover")},getsongUrl:function(){var t=this;Object(r["i"])(this,{id:this.id}).then((function(n){t.url=n.data[0].url,t.audioInit()})).catch((function(t){console.log(t)}))},getlyric:function(){var t=this;Object(r["e"])(this,{id:this.id}).then((function(n){t.parseLyric=a["a"]._parseLyric(n.lrc.lyric)})).catch((function(t){console.log(t)}))},getsongdetail:function(t){var n=this;Object(r["h"])(this,{ids:t}).then((function(t){n.songs=n.songs.concat(t.songs),n.song_page++,n.currentShowNum=n.songs.length,n.songname=n.songs[0].name,n.songTime=n.songs[0].dt,n.getSongImg()}))},getSongImg:function(){var t=this;Object(o["a"])(this,{keywords:this.songname}).then((function(n){t.songUrl=n.result.songs[0].al.picUrl})).catch((function(t){console.log(t)}))},barDown:function(){this.down=!0,this.play=!1},prograssInit:function(){var t=this;this.prograssDistance=document.querySelector(".prograss-container").offsetWidth-document.querySelector(".bar").offsetWidth,document.onmousemove=function(n){if(t.down){var e=n.pageX,i=document.querySelector(".bar"),s=document.querySelector(".prograss-container"),r=document.querySelector(".current-time"),o=document.querySelector(".prograss").offsetLeft,a=s.offsetLeft,c=s.offsetWidth,u=i.offsetWidth,l=e-a-o-u/2;l=l<0?0:l,l=l>c-u?c-u:l,i.style.left=l+"px",r.style.width=l+"px",t.currentDistance=l}},document.onmouseup=function(){t.down&&(t.down=!1,t.currentTime())}},currentTime:function(){var t=document.querySelector("audio"),n=this.currentDistance*(this.songTime/this.prograssDistance)/1e3;t.currentTime=n,this.play=!0},audioInit:function(){var t=this,n=document.querySelector("audio"),e=document.querySelector(".lrc-container");n.addEventListener("timeupdate",(function(){var i=n.currentTime;t.timeStamp=1e3*i;for(var s=(""+i).split(".")[0],r=0;r<t.parseLyric.length;r++)if((""+t.parseLyric[r].time).split(".")[0]==s){t.active=r;var o=document.querySelectorAll(".lrc")[r];e.style.top=100-o.offsetTop+"px";break}})),n.addEventListener("ended",(function(){t.play=!1,console.log("音频播放结束"),t.timeStamp=t.songTime,t.reset(),t.item_index++}))},isplay:function(){this.play=!this.play},goSingerDetail:function(t,n){this.$router.push({path:"/singerDetail/".concat((new Date).getTime()),query:{id:t,name:n}})},reset:function(){var t=document.querySelector(".lrc-container");t.style.top="100px",this.timeStamp=0,this.play=!1}},beforeDestroy:function(){this.play=!1}},u=c,l=(e("ece7"),e("cba8")),d=Object(l["a"])(u,i,s,!1,null,"0910a504",null);n["default"]=d.exports},ca85:function(t,n,e){"use strict";e.d(n,"d",(function(){return r})),e.d(n,"k",(function(){return o})),e.d(n,"c",(function(){return a})),e.d(n,"j",(function(){return c})),e.d(n,"f",(function(){return u})),e.d(n,"h",(function(){return l})),e.d(n,"g",(function(){return d})),e.d(n,"a",(function(){return g})),e.d(n,"i",(function(){return h})),e.d(n,"e",(function(){return m})),e.d(n,"b",(function(){return f}));var i=e("e760"),s=e("4c8d");function r(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(i["a"])(s["g"],n,t)}function o(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(i["a"])(s["z"],n,t)}function a(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(i["a"])(s["b"],n,t)}function c(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(i["a"])(s["c"],n,t)}function u(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(i["a"])(s["n"],n,t)}function l(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(i["a"])(s["w"],n,t)}function d(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(i["a"])(s["p"],n,t)}function g(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(i["a"])(s["e"],n,t)}function h(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(i["a"])(s["x"],n,t)}function m(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(i["a"])(s["h"],n,t)}function f(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(i["a"])(s["a"],n,t)}},d30f:function(t,n,e){var i=e("73ad"),s=e("e907").EXISTS,r=e("0fe9").f,o=Function.prototype,a=o.toString,c=/^\s*function ([^ (]*)/,u="name";i&&!s&&r(o,u,{configurable:!0,get:function(){try{return a.call(this).match(c)[1]}catch(t){return""}}})},ece7:function(t,n,e){"use strict";e("33e7")}}]);
//# sourceMappingURL=chunk-dc4a5c88.15a74948.js.map